<%@page import="java.util.Date"%><%@page import="java.text.SimpleDateFormat"%><%@page import="com.yinhai.sysframework.util.WebUtil"%><%@page import="com.yinhai.sysframework.iorg.IUser"%><%@page import="com.yinhai.sysframework.config.SysConfig"%><%@page import="com.yinhai.sysframework.service.AppManager"%><%@page language="java" pageEncoding="UTF-8"%><%	String path = request.getContextPath();			    String basePath = request.getScheme() + "://" + request.getServerName() + ":" + request.getServerPort() + path + "/";			    //如果用户已经登录，直接跳到首页			    IUser user = WebUtil.getUserInfo(request);			    if (user != null && null != user.getUserId()) {				    	response.sendRedirect("indexAction.do");				    	return;			    }			    Date now = new Date();			    SimpleDateFormat formatter = new SimpleDateFormat("yyyy年MM月dd日   E");			    request.setAttribute("date", formatter.format(now));					    response.addHeader("__timeout", "true");			    boolean developMode = SysConfig.getSysconfigToBoolean("developMode");			    String sameLogin = (String) request.getParameter("samelogin");			    String param = request.getQueryString();			    if (param != null) {				    	param = param.replaceAll("'", "");				    	param = param.replaceAll("\"", "&quot;");			    }			    String postId = String.valueOf(Math.random());			    request.getSession(false).setAttribute("_POSTID", postId);			    response.addHeader("Set-Cookie", "POSTID=" + postId + ";Path=" + request.getContextPath() + ";HttpOnly");%><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=8; IE=9; IE=10" /><link href="indexue/loginresource/css/login.css" rel="stylesheet" type="text/css" /><title>系统登录</title></head><body>	<div class="header">		<div class="headerInfo">			<span class="time">今天是：${date}</span> 			<a onclick="fnSetHome(location.pathname)" class="home" href="javascript:void(0)">设为首页</a> 			<a onclick="fnAddFavorite(window.location, document.title)" class="collect" href="javascript:void(0)">加入收藏</a>		</div>		<h1 class="headerLogo">			<img src="indexue/loginresource/images/logo.gif">		</h1>		<div class="headerNav">			<a target="_blank" href="">华软官网</a> 			<a target="_blank" href="">关于华软</a> 			<a target="_blank" href="">开发团队</a> 			<a target="_blank" href="">意见反馈</a> 			<a target="_blank" href="">帮助</a>		</div>	</div>	<div class="banner">		<div class="loginbox">			<div class="loginfrom">				<div class="error-box">公共场所不建议保存密码，以防账号丢失</div>				<div class="fm-item">					<label class="form-label">用户名 <span>Username</span></label> 					<input id="username" type="text" class="i-text" placeholder="输入账号" />				</div>				<div class="fm-item">					<label class="form-label">密码 <span>Password</span></label> 					<input id="password" type="password" class="i-text" placeholder="输入密码" />				</div>				<div class="fm-item pos-r">					<label class="form-label">验证码 <span>Code</span></label> 					<input id="checkcode" type="text" class="i-text" style="width:112px;" placeholder="输入验证码" />					<div>						<img id="code" src="CaptchaImg" class="chckcode-img" title="点击获取验证码"/>					</div>				</div>				<div class="fm-item">					<input id="remberPass" type="checkbox" class="rember" value="">记住密码</input> 					<a id="changePass" href="#" onclick="fnOpenModifyPsd()">修改密码</a>				</div>				<div class="fm-item">					<input id="send-btn" type="button" class="btn-login" tabindex="4" />				</div>			</div>		</div>	</div>	<div class="footer" id="footer">		技术支持：四川久远银海软件股份有限责任公司<br /> Surport:SiChuan yinhai Software Limited By Share Ltd	</div>	<!-- 遮罩层start -->	<div class="mask" id="mask"></div>	<!-- 遮罩层end -->	<div id="psdmodify" class="psdmodify" >		<div class="title">			密码修改<a href="javascript:;" onclick="fnCloseModifyPsd()" class="close" title="关闭"></a>		</div>		<form id="psdmodifyform">			<table cellpadding="0" cellspacing="0" width="0">				<tr>					<td class="lable">用户名</td>					<td><input id="loginId" name="dto['loginId']" required="true" type="text" title="用户名" onkeyup="loginIdKeyup(this)" /></td>				</tr>				<tr>					<td class="lable">密码</td>					<td><input name="dto['oldPass']" type="password" id="oldPass" required="true" title="密码" onkeyup="oldPassKeyup(this)" /></td>				</tr>				<tr>					<td class="lable">新密码</td>					<td><input type="password" id="newPass" name="dto['newPass']" required="true" title="新密码" onkeyup="newPassKeyup(this)" /></td>				</tr>				<tr>					<td class="lable">确认密码</td>					<td><input type="password" id="rpassword" onkeyup="rpasswordKeyup(this)" name="dto['rpassword']" required="true" title="确认密码" /></td>				</tr>				<tr>					<td class="lable">验证码</td>					<td>						<input id="checkCodePass" name="dto['checkCodePass']" onkeyup="checkCodePassKeyup(this)" type="text" class="captcha" title="验证码" />						<img id="codeimgPass" onclick="javascript:refeshCodePass();" src="CaptchaImgPass" title="看不清,换一张" />					</td>				</tr>				<tr>					<td class="lable">&nbsp;</td>					<td><input type="button" class="submit" border="0" value="确认修改" id="modifyPsd" onclick="fnSavePass()" /></td>				</tr>				<tr>					<td colspan="2" id="errornotice"></td>				</tr>			</table>		</form>	</div></body><script type="text/javascript">//浏览器视口的宽度function windowWidth() {	var de = document.documentElement;	return self.innerWidth || (de && de.clientWidth)|| document.body.clientWidth;}//关闭修改密码窗口function fnCloseModifyPsd() {	mask.style.display = "none";	psdmodify.style.display = "none";	document.getElementById("psdmodifyform").reset();}//浏览器视口的高度function windowHeight() {	var de = document.documentElement;	return self.innerHeight || (de && de.clientHeight) || document.body.clientHeight;}//修改密码，验证码function refeshCodePass() {	document.getElementById("codeimgPass").src = "<%=ctxPath%>/CaptchaImgPass?j="+ Math.random();};function fnOpenModifyPsd() {	var tp = windowHeight() - 342 >= 0 ? (windowHeight() - 342) / 2 : 0;	var lt = windowWidth() - 402 >= 0 ? (windowWidth() - 402) / 2 : 0;	mask.style.display = "block";	psdmodify.style.top = tp + "px";	psdmodify.style.left = lt + "px";	psdmodify.style.display = "block";	document.getElementById("loginId").focus();}//设为首页function fnSetHome(obj, url) {	if (document.all) {		try {		console.log(url);			document.body.style.behavior = 'url(#default#homepage)';			document.body.setHomePage(url);		} catch (e) {			if (window.netscape) {				try {					netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");				} catch (e) {					alert("抱歉，此操作被浏览器拒绝！\n\n请在浏览器地址栏输入“about:config”并回车然后将[signed.applets.codebase_principal_support]设置为'true'");				}			} else {				alert("抱歉，您所使用的浏览器无法完成此操作。\n\n您需要手动将【" + url + "】设置为首页。");			}		}	} else {		alert("您的浏览器不支持自动设置页面为首页功能，请您手动在浏览器里设置该页面为首页！");	}}//收藏function fnAddFavorite(sURL, sTitle) {	sURL = encodeURI(sURL);	try {		window.external.addFavorite(sURL, sTitle);	} catch (e) {		try {			window.sidebar.addPanel(sTitle, sURL, "");		} catch (e) {			alert("您的浏览器不支持自动加入收藏功能，请使用Ctrl+D进行添加，或手动在浏览器里进行设置！");		}	}}</script></html>